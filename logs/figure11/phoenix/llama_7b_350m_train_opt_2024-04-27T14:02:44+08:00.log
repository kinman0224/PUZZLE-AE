/home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
  warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
2024-04-27 14:02:53,015	INFO worker.py:1724 -- Started a local Ray instance.
[36m(pid=2230265)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2230265)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231486)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231486)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231483)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231483)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231484)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231484)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231485)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231485)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231488)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231488)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231482)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231482)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(pid=2231487)[0m /home/zhaijidong/miniconda3/envs/ljw/lib/python3.9/site-packages/apex/pyprof/__init__.py:5: FutureWarning: pyprof will be removed by the end of June, 2022
[36m(pid=2231487)[0m   warnings.warn("pyprof will be removed by the end of June, 2022", FutureWarning)
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:08 INFO     Added key: store_based_barrier_key:1 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:08 INFO     Added key: store_based_barrier_key:1 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:08 INFO     Added key: store_based_barrier_key:1 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:1 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:1 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:1 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:1 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:1 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:2 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:3 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:3 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:4 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:4 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:5 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:5 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:6 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:6 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:7 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:7 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:8 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:8 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:9 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:9 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:10 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:10 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:11 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:11 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:12 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:12 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:13 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:13 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:14 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:14 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:15 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:15 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:16 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:16 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:17 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:17 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:18 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:18 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:19 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 6
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:19 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:20 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 3
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 7
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 1
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 0
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 4
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 5
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:20 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Added key: store_based_barrier_key:21 to store for rank: 2
[36m(TimeSharedModelRayRole pid=2231483)[0m 2024-04-27 14:03:09 INFO     Rank 2: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231488)[0m 2024-04-27 14:03:09 INFO     Rank 7: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231482)[0m 2024-04-27 14:03:09 INFO     Rank 1: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231487)[0m 2024-04-27 14:03:09 INFO     Rank 6: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231484)[0m 2024-04-27 14:03:09 INFO     Rank 3: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m 2024-04-27 14:03:09 INFO     Rank 0: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231485)[0m 2024-04-27 14:03:09 INFO     Rank 4: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2231486)[0m 2024-04-27 14:03:09 INFO     Rank 5: Completed store-based barrier for key:store_based_barrier_key:21 with 8 nodes.
[36m(TimeSharedModelRayRole pid=2230265)[0m Detected CUDA files, patching ldflags
[36m(TimeSharedModelRayRole pid=2230265)[0m Emitting ninja build file /home/zhaijidong/kinman/ae/puzzle/megatron/fused_kernels/build/build.ninja...
[36m(TimeSharedModelRayRole pid=2230265)[0m Building extension module scaled_upper_triang_masked_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[36m(TimeSharedModelRayRole pid=2230265)[0m Loading extension module scaled_upper_triang_masked_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m Detected CUDA files, patching ldflags
[36m(TimeSharedModelRayRole pid=2230265)[0m Emitting ninja build file /home/zhaijidong/kinman/ae/puzzle/megatron/fused_kernels/build/build.ninja...
[36m(TimeSharedModelRayRole pid=2230265)[0m Building extension module scaled_masked_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[36m(TimeSharedModelRayRole pid=2230265)[0m Loading extension module scaled_masked_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m Detected CUDA files, patching ldflags
[36m(TimeSharedModelRayRole pid=2230265)[0m Emitting ninja build file /home/zhaijidong/kinman/ae/puzzle/megatron/fused_kernels/build/build.ninja...
[36m(TimeSharedModelRayRole pid=2230265)[0m Building extension module scaled_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[36m(TimeSharedModelRayRole pid=2230265)[0m Loading extension module scaled_softmax_cuda...
[36m(TimeSharedModelRayRole pid=2230265)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2230265)[0m using world size: 8, data-parallel-size: 1, tensor-model-parallel size: 1, pipeline-model-parallel size: 8
[36m(TimeSharedModelRayRole pid=2230265)[0m using torch.float16 for parameters ...
[36m(TimeSharedModelRayRole pid=2230265)[0m ------------------------ arguments ------------------------
[36m(TimeSharedModelRayRole pid=2230265)[0m   accumulate_allreduce_grads_in_fp32 .............. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   actor_model_name_or_path ........................ /home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/
[36m(TimeSharedModelRayRole pid=2230265)[0m   adam_beta1 ...................................... 0.9
[36m(TimeSharedModelRayRole pid=2230265)[0m   adam_beta2 ...................................... 0.999
[36m(TimeSharedModelRayRole pid=2230265)[0m   adam_eps ........................................ 1e-08
[36m(TimeSharedModelRayRole pid=2230265)[0m   add_bias_linear ................................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   add_position_embedding .......................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   adlr_autoresume ................................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   adlr_autoresume_interval ........................ 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   apply_layernorm_1p .............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   apply_query_key_layer_scaling ................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   apply_residual_connection_post_layernorm ........ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   ar_stage_mbs .................................... 16
[36m(TimeSharedModelRayRole pid=2230265)[0m   async_tensor_model_parallel_allreduce ........... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   attention_dropout ............................... 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   attention_softmax_in_fp32 ....................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   barrier_with_L1_time ............................ True
[36m(TimeSharedModelRayRole pid=2230265)[0m   bert_binary_head ................................ True
[36m(TimeSharedModelRayRole pid=2230265)[0m   bert_embedder_type .............................. megatron
[36m(TimeSharedModelRayRole pid=2230265)[0m   bert_load ....................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   bf16 ............................................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   bias_dropout_fusion ............................. True
[36m(TimeSharedModelRayRole pid=2230265)[0m   bias_gelu_fusion ................................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   biencoder_projection_dim ........................ 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   biencoder_shared_query_context_model ............ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   block_data_path ................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   bulk_switch_on .................................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   classes_fraction ................................ 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   clip_grad ....................................... 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   consumed_train_samples .......................... 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   consumed_valid_samples .......................... 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   critic_model_name_or_path ....................... /home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_impl ....................................... infer
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_output_path ................................ /tmp/data_files
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_parallel_random_init ....................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_parallel_size .............................. 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_path ....................................... ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static']
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_per_class_fraction ......................... 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_sharding ................................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   data_split ...................................... 2,4,4
[36m(TimeSharedModelRayRole pid=2230265)[0m   dataloader_type ................................. single
[36m(TimeSharedModelRayRole pid=2230265)[0m   DDP_impl ........................................ local
[36m(TimeSharedModelRayRole pid=2230265)[0m   decoder_num_layers .............................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   decoder_seq_length .............................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_bottleneck_size ............................ 256
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_freeze_last_layer .......................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_head_hidden_size ........................... 2048
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_local_crops_number ......................... 10
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_local_img_size ............................. 96
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_norm_last_layer ............................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_teacher_temp ............................... 0.07
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_warmup_teacher_temp ........................ 0.04
[36m(TimeSharedModelRayRole pid=2230265)[0m   dino_warmup_teacher_temp_epochs ................. 30
[36m(TimeSharedModelRayRole pid=2230265)[0m   distribute_saved_activations .................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   distributed_backend ............................. nccl
[36m(TimeSharedModelRayRole pid=2230265)[0m   distributed_timeout_minutes ..................... 10
[36m(TimeSharedModelRayRole pid=2230265)[0m   embedding_path .................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   empty_unused_memory_level ....................... 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   encoder_num_layers .............................. 32
[36m(TimeSharedModelRayRole pid=2230265)[0m   encoder_seq_length .............................. 512
[36m(TimeSharedModelRayRole pid=2230265)[0m   end_weight_decay ................................ 0.01
[36m(TimeSharedModelRayRole pid=2230265)[0m   eod_mask_loss ................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   eval_interval ................................... 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   eval_iters ...................................... 100
[36m(TimeSharedModelRayRole pid=2230265)[0m   evidence_data_path .............................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   exit_duration_in_mins ........................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   exit_interval ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   exit_on_missing_checkpoint ...................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   exit_signal_handler ............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   exp_repeat ...................................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   ffn_hidden_size ................................. 11008
[36m(TimeSharedModelRayRole pid=2230265)[0m   finetune ........................................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp16 ............................................ True
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp16_lm_cross_entropy ........................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp32_residual_connection ........................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_amax_compute_algo ........................... most_recent
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_amax_history_len ............................ 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_e4m3 ........................................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_hybrid ...................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_interval .................................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_margin ...................................... 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   fp8_wgrad ....................................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   generation_batches .............................. 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   global_batch_size ............................... 128
[36m(TimeSharedModelRayRole pid=2230265)[0m   gradient_accumulation_fusion .................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   gradient_accumulation_steps ..................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   head_lr_mult .................................... 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   hidden_dropout .................................. 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   hidden_size ..................................... 4096
[36m(TimeSharedModelRayRole pid=2230265)[0m   hysteresis ...................................... 2
[36m(TimeSharedModelRayRole pid=2230265)[0m   ict_head_size ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   ict_load ........................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   img_h ........................................... 224
[36m(TimeSharedModelRayRole pid=2230265)[0m   img_w ........................................... 224
[36m(TimeSharedModelRayRole pid=2230265)[0m   indexer_batch_size .............................. 128
[36m(TimeSharedModelRayRole pid=2230265)[0m   indexer_log_interval ............................ 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   inference_batch_times_seqlen_threshold .......... 1024
[36m(TimeSharedModelRayRole pid=2230265)[0m   init_method_std ................................. 0.02
[36m(TimeSharedModelRayRole pid=2230265)[0m   init_method_xavier_uniform ...................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   initial_loss_scale .............................. 4294967296
[36m(TimeSharedModelRayRole pid=2230265)[0m   iter_per_epoch .................................. 1250
[36m(TimeSharedModelRayRole pid=2230265)[0m   kv_channels ..................................... 128
[36m(TimeSharedModelRayRole pid=2230265)[0m   layernorm_epsilon ............................... 1e-05
[36m(TimeSharedModelRayRole pid=2230265)[0m   lazy_mpu_init ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   load ............................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   load_model_from_hf_config ....................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   load_model_hf_checkpoint ........................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   local_rank ...................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_batch_size_to_tensorboard ................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_interval .................................... 100
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_learning_rate_to_tensorboard ................ True
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_loss_scale_to_tensorboard ................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_memory_to_tensorboard ....................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_num_zeros_in_grad ........................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_params_norm ................................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_timers_to_tensorboard ....................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_validation_ppl_to_tensorboard ............... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   log_world_size_to_tensorboard ................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   loss_scale ...................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   loss_scale_window ............................... 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr .............................................. 0.00015
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_decay_iters .................................. 320000
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_decay_samples ................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_decay_style .................................. cosine
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_warmup_fraction .............................. 0.01
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_warmup_iters ................................. 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   lr_warmup_samples ............................... 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   make_vocab_size_divisible_by .................... 128
[36m(TimeSharedModelRayRole pid=2230265)[0m   mask_factor ..................................... 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   mask_prob ....................................... 0.15
[36m(TimeSharedModelRayRole pid=2230265)[0m   mask_type ....................................... random
[36m(TimeSharedModelRayRole pid=2230265)[0m   masked_softmax_fusion ........................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   max_answer_seq_len .............................. 256
[36m(TimeSharedModelRayRole pid=2230265)[0m   max_position_embeddings ......................... 512
[36m(TimeSharedModelRayRole pid=2230265)[0m   max_prompt_seq_len .............................. 256
[36m(TimeSharedModelRayRole pid=2230265)[0m   max_tokens_to_oom ............................... 12000
[36m(TimeSharedModelRayRole pid=2230265)[0m   merge_file ...................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   micro_batch_size ................................ 4
[36m(TimeSharedModelRayRole pid=2230265)[0m   min_loss_scale .................................. 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   min_lr .......................................... 1e-05
[36m(TimeSharedModelRayRole pid=2230265)[0m   mmap_warmup ..................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   model_name_or_path .............................. /home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/
[36m(TimeSharedModelRayRole pid=2230265)[0m   no_load_optim ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   no_load_rng ..................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   no_persist_layer_norm ........................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   no_save_optim ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   no_save_rng ..................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_attention_heads ............................. 32
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_channels .................................... 3
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_classes ..................................... 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_experts ..................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_layers ...................................... 32
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_layers_per_virtual_pipeline_stage ........... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_train_epochs ................................ 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   num_workers ..................................... 2
[36m(TimeSharedModelRayRole pid=2230265)[0m   onnx_safe ....................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   openai_gelu ..................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   optimizer ....................................... adam
[36m(TimeSharedModelRayRole pid=2230265)[0m   output_bert_embeddings .......................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   override_opt_param_scheduler .................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   params_dtype .................................... torch.float16
[36m(TimeSharedModelRayRole pid=2230265)[0m   patch_dim ....................................... 16
[36m(TimeSharedModelRayRole pid=2230265)[0m   perform_initialization .......................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   pf_stage_mbs .................................... 4
[36m(TimeSharedModelRayRole pid=2230265)[0m   pipeline_model_parallel_size .................... 8
[36m(TimeSharedModelRayRole pid=2230265)[0m   pipeline_model_parallel_split_rank .............. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   placement_type .................................. 4
[36m(TimeSharedModelRayRole pid=2230265)[0m   ppo_epochs ...................................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   query_in_block_prob ............................. 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   rampup_batch_size ............................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   rank ............................................ 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   recompute_granularity ........................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   recompute_method ................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   recompute_num_layers ............................ 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   reset_attention_mask ............................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   reset_position_ids .............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   retriever_report_topk_accuracies ................ []
[36m(TimeSharedModelRayRole pid=2230265)[0m   retriever_score_scaling ......................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   retriever_seq_length ............................ 256
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_add_retriever ............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_cyclic_train_iters ........................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_encoder_attention_dropout ................. 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_encoder_hidden_dropout .................... 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_encoder_layers ............................ 2
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_num_neighbors ............................. 2
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_num_retrieved_chunks ...................... 2
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_return_doc_ids ............................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   retro_workdir ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   rotary_percent .................................. 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   sample_rate ..................................... 1.0
[36m(TimeSharedModelRayRole pid=2230265)[0m   save ............................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   save_interval ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   scatter_gather_tensors_in_pipeline .............. True
[36m(TimeSharedModelRayRole pid=2230265)[0m   seed ............................................ 1234
[36m(TimeSharedModelRayRole pid=2230265)[0m   seq_length ...................................... 512
[36m(TimeSharedModelRayRole pid=2230265)[0m   sequence_parallel ............................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   sgd_momentum .................................... 0.9
[36m(TimeSharedModelRayRole pid=2230265)[0m   shadow_pipeline_model_parallel_size ............. 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   shadow_tensor_model_parallel_size ............... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   short_seq_prob .................................. 0.1
[36m(TimeSharedModelRayRole pid=2230265)[0m   split ........................................... 969, 30, 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   squared_relu .................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   standalone_embedding_stage ...................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   start_weight_decay .............................. 0.01
[36m(TimeSharedModelRayRole pid=2230265)[0m   swiglu .......................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   swin_backbone_type .............................. tiny
[36m(TimeSharedModelRayRole pid=2230265)[0m   tensor_model_parallel_size ...................... 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   tensorboard_dir ................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   tensorboard_log_interval ........................ 1
[36m(TimeSharedModelRayRole pid=2230265)[0m   tensorboard_queue_size .......................... 1000
[36m(TimeSharedModelRayRole pid=2230265)[0m   test_data_path .................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   timing_log_level ................................ 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   timing_log_option ............................... minmax
[36m(TimeSharedModelRayRole pid=2230265)[0m   titles_data_path ................................ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   tokenizer_model ................................. /home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/
[36m(TimeSharedModelRayRole pid=2230265)[0m   tokenizer_type .................................. PretrainedFromHF
[36m(TimeSharedModelRayRole pid=2230265)[0m   train_data_path ................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   train_iters ..................................... 500000
[36m(TimeSharedModelRayRole pid=2230265)[0m   train_samples ................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   transformer_impl ................................ local
[36m(TimeSharedModelRayRole pid=2230265)[0m   transformer_pipeline_model_parallel_size ........ 8
[36m(TimeSharedModelRayRole pid=2230265)[0m   untie_embeddings_and_output_weights ............. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_checkpoint_args ............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_checkpoint_opt_param_scheduler .............. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_contiguous_buffers_in_local_ddp ............. True
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_cpu_initialization .......................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_dis_bubble_generation ....................... True
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_distributed_optimizer ....................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_flash_attn .................................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_one_sent_docs ............................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_ring_exchange_p2p ........................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_rotary_position_embeddings .................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   use_shadow ...................................... False
[36m(TimeSharedModelRayRole pid=2230265)[0m   valid_data_path ................................. None
[36m(TimeSharedModelRayRole pid=2230265)[0m   variable_seq_lengths ............................ False
[36m(TimeSharedModelRayRole pid=2230265)[0m   virtual_pipeline_model_parallel_size ............ None
[36m(TimeSharedModelRayRole pid=2230265)[0m   vision_backbone_type ............................ vit
[36m(TimeSharedModelRayRole pid=2230265)[0m   vision_pretraining .............................. False
[36m(TimeSharedModelRayRole pid=2230265)[0m   vision_pretraining_type ......................... classify
[36m(TimeSharedModelRayRole pid=2230265)[0m   vocab_extra_ids ................................. 0
[36m(TimeSharedModelRayRole pid=2230265)[0m   vocab_file ...................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   vocab_size ...................................... None
[36m(TimeSharedModelRayRole pid=2230265)[0m   weight_decay .................................... 0.01
[36m(TimeSharedModelRayRole pid=2230265)[0m   weight_decay_incr_style ......................... constant
[36m(TimeSharedModelRayRole pid=2230265)[0m   world_size ...................................... 8
[36m(TimeSharedModelRayRole pid=2230265)[0m -------------------- end of arguments ---------------------
[36m(TimeSharedModelRayRole pid=2230265)[0m setting number of micro-batches to constant 32
[36m(TimeSharedModelRayRole pid=2230265)[0m > building PretrainedFromHF tokenizer ...
[36m(TimeSharedModelRayRole pid=2230265)[0m  Loading tokenizer from pre-trained model
[36m(TimeSharedModelRayRole pid=2230265)[0m  > padded vocab (size: 32000) with 0 dummy tokens (new size: 32000)
[36m(TimeSharedModelRayRole pid=2230265)[0m > initializing torch distributed ...
[36m(TimeSharedModelRayRole pid=2231486)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231484)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231483)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231482)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231485)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231488)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2231487)[0m {'tokenizer_type': 'PretrainedFromHF', 'tokenizer_model': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'data_path': ['/home/zhaijidong/kinman/hf-datasets/Dahoas/rm-static'], 'data_split': '2,4,4', 'data_output_path': '/tmp/data_files', 'seq_length': 512, 'actor_model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'critic_model_name_or_path': '/home/zhaijidong/kinman/ae/puzzle/puzzle/example/config/Llama2-350m-hf/', 'max_prompt_seq_len': 256, 'max_answer_seq_len': 256, 'generation_batches': 1, 'ppo_epochs': 1, 'num_train_epochs': 1, 'gradient_accumulation_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 8, 'use_contiguous_buffers_in_local_ddp': True, 'load_model_from_hf_config': True, 'load_model_hf_checkpoint': False, 'model_name_or_path': '/home/zhaijidong/kinman/hf-models/Llama-2-7b-sft-model-ocra-500k/', 'max_position_embeddings': 512, 'micro_batch_size': 4, 'global_batch_size': 128, 'inference_batch_times_seqlen_threshold': 1024, 'train_iters': 500000, 'add_bias_linear': False, 'add_position_embedding': False, 'lr': 0.00015, 'lr_decay_style': 'cosine', 'lr_decay_iters': 320000, 'min_lr': 1e-05, 'lr_warmup_fraction': 0.01, 'weight_decay': 0.01, 'clip_grad': 1.0, 'fp16': True, 'bf16': False, 'use_dis_bubble_generation': True, 'pf_stage_mbs': 4, 'ar_stage_mbs': 16, 'use_shadow': False, 'shadow_tensor_model_parallel_size': 1, 'shadow_pipeline_model_parallel_size': 1, 'bulk_switch_on': False, 'exp_repeat': 1, 'placement_type': 4}
[36m(TimeSharedModelRayRole pid=2230265)[0m > initialized tensor model parallel with size 1
[36m(TimeSharedModelRayRole pid=2230265)[0m > initialized pipeline model parallel with size 8
[36m(TimeSharedModelRayRole pid=2230265)[0m > setting random seeds to 1234 ...
[36m(TimeSharedModelRayRole pid=2230265)[0m > compiling dataset index builder ...
[36m(TimeSharedModelRayRole pid=2230265)[0m make: Entering directory '/home/zhaijidong/kinman/ae/puzzle/megatron/data'
[36m(TimeSharedModelRayRole pid=2230265)[0m make: Nothing to be done for 'default'.
[36m(TimeSharedModelRayRole pid=2230265)[0m make: Leaving directory '/home/zhaijidong/kinman/ae/puzzle/megatron/data'
[36m(TimeSharedModelRayRole pid=2230265)[0m >>> done with dataset index builder. Compilation time: 0.099 seconds
[36m(TimeSharedModelRayRole pid=2230265)[0m > compiling and loading fused kernels ...
[36m(TimeSharedModelRayRole pid=2230265)[0m ninja: no work to do.
[36m(TimeSharedModelRayRole pid=2230265)[0m ninja: no work to do.
[36m(TimeSharedModelRayRole pid=2230265)[0m ninja: no work to do.
[36m(TimeSharedModelRayRole pid=2230265)[0m >>> done with compiling and loading fused kernels. Compilation time: 5.916 seconds
[36m(TimeSharedModelRayRole pid=2230265)[0m building Llama model ...
[36m(TimeSharedModelRayRole pid=2231484)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 809533440
[36m(TimeSharedModelRayRole pid=2231487)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 6): 809533440
[36m(TimeSharedModelRayRole pid=2231483)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 2): 809533440
[36m(TimeSharedModelRayRole pid=2231483)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 2): 42207232
[36m(TimeSharedModelRayRole pid=2230265)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 940605440
[36m(TimeSharedModelRayRole pid=2230265)[0m > learning rate decay style: cosine
[36m(TimeSharedModelRayRole pid=2230265)[0m building Llama model ...
[36m(TimeSharedModelRayRole pid=2230265)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 58591232
[36m(TimeSharedModelRayRole pid=2230265)[0m > learning rate decay style: cosine
[36m(TimeSharedModelRayRole pid=2230265)[0m building Llama model ...
[36m(TimeSharedModelRayRole pid=2231488)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 7): 940609536
[36m(TimeSharedModelRayRole pid=2231488)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 7): 42208256
[36m(TimeSharedModelRayRole pid=2231488)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 7): 940609536
[36m(TimeSharedModelRayRole pid=2231482)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 1): 809533440
[36m(TimeSharedModelRayRole pid=2231484)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 42207232
[36m(TimeSharedModelRayRole pid=2231484)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 809533440
[36m(TimeSharedModelRayRole pid=2231484)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 42207232
[36m(TimeSharedModelRayRole pid=2231487)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 6): 42207232
[36m(TimeSharedModelRayRole pid=2231487)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 6): 809533440
[36m(TimeSharedModelRayRole pid=2231487)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 6): 42207232
[36m(TimeSharedModelRayRole pid=2231483)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 2): 809533440
[36m(TimeSharedModelRayRole pid=2231483)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 2): 42207232
[36m(TimeSharedModelRayRole pid=2231486)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 5): 809533440
[36m(TimeSharedModelRayRole pid=2231486)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 5): 42207232
[36m(TimeSharedModelRayRole pid=2231486)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 5): 809533440
[36m(TimeSharedModelRayRole pid=2231486)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 5): 42207232
[36m(TimeSharedModelRayRole pid=2230265)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 940605440
[36m(TimeSharedModelRayRole pid=2230265)[0m building Llama model ...
[36m(TimeSharedModelRayRole pid=2231488)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 7): 42208256
[36m(TimeSharedModelRayRole pid=2231482)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 1): 42207232
[36m(TimeSharedModelRayRole pid=2231485)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 809533440
[36m(TimeSharedModelRayRole pid=2230265)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 58591232
[36m(TimeSharedModelRayRole pid=2231482)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 1): 809533440
[36m(TimeSharedModelRayRole pid=2231482)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 1): 42207232
[36m(TimeSharedModelRayRole pid=2231485)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 42207232
num_total_iters: 477
Beginning of Epoch 1/1, Total Generation Batches 477
[36m(TimeSharedModelRayRole pid=2231485)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 809533440
[36m(TimeSharedModelRayRole pid=2231485)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 42207232
epoch: 0 | step: 0/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.176 | act_loss: 5.719 | cri_loss: 5.067 | stage 1(gen.) (ms): 12261.287 | stage 2(infer.) (ms): 4410.588 | stage 3(train.) (ms): 7487.318 | e2e_time (ms): 24159.194
epoch: 0 | step: 1/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.182 | act_loss: 5.829 | cri_loss: 5.072 | stage 1(gen.) (ms): 9623.531 | stage 2(infer.) (ms): 1337.316 | stage 3(train.) (ms): 4580.950 | e2e_time (ms): 15541.797
epoch: 0 | step: 2/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.174 | act_loss: 5.656 | cri_loss: 5.236 | stage 1(gen.) (ms): 9721.447 | stage 2(infer.) (ms): 1328.183 | stage 3(train.) (ms): 4542.714 | e2e_time (ms): 15592.343
epoch: 0 | step: 3/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.223 | act_loss: 5.629 | cri_loss: 5.180 | stage 1(gen.) (ms): 9627.688 | stage 2(infer.) (ms): 1322.493 | stage 3(train.) (ms): 4534.801 | e2e_time (ms): 15484.981
epoch: 0 | step: 4/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.216 | act_loss: 5.647 | cri_loss: 5.167 | stage 1(gen.) (ms): 9797.375 | stage 2(infer.) (ms): 1330.780 | stage 3(train.) (ms): 4555.258 | e2e_time (ms): 15683.413
epoch: 0 | step: 5/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.164 | act_loss: 5.901 | cri_loss: 5.139 | stage 1(gen.) (ms): 9934.122 | stage 2(infer.) (ms): 1302.434 | stage 3(train.) (ms): 4514.052 | e2e_time (ms): 15750.607
epoch: 0 | step: 6/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.097 | act_loss: 5.485 | cri_loss: 5.145 | stage 1(gen.) (ms): 9647.379 | stage 2(infer.) (ms): 1288.515 | stage 3(train.) (ms): 4546.985 | e2e_time (ms): 15482.879
epoch: 0 | step: 7/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.210 | act_loss: 5.512 | cri_loss: 4.974 | stage 1(gen.) (ms): 9983.268 | stage 2(infer.) (ms): 1295.634 | stage 3(train.) (ms): 4521.721 | e2e_time (ms): 15800.623
epoch: 0 | step: 8/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.137 | act_loss: 5.535 | cri_loss: 5.147 | stage 1(gen.) (ms): 9667.000 | stage 2(infer.) (ms): 1309.282 | stage 3(train.) (ms): 4547.094 | e2e_time (ms): 15523.375
epoch: 0 | step: 9/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.202 | act_loss: 5.694 | cri_loss: 5.089 | stage 1(gen.) (ms): 9675.577 | stage 2(infer.) (ms): 1308.810 | stage 3(train.) (ms): 4536.582 | e2e_time (ms): 15520.970
epoch: 0 | step: 10/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.199 | act_loss: 5.765 | cri_loss: 5.092 | stage 1(gen.) (ms): 9608.142 | stage 2(infer.) (ms): 1357.467 | stage 3(train.) (ms): 4728.065 | e2e_time (ms): 15693.674
epoch: 0 | step: 11/477 | ppo_ep: 1 | global_batch_size: 128 | average_reward: -0.172 | act_loss: 5.596 | cri_loss: 5.208 | stage 1(gen.) (ms): 10657.760 | stage 12infer.) (ms): 1329.438 | stage 3(train.) (ms): 4525.213 | e2e_time (ms): 16512.411
exit with early finished, for debug
